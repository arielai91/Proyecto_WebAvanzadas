<div class="pet-form-container">
  <div class="form-card">
    <h2>{{ isEditMode ? '✏️ Editar Mascota' : '➕ Nueva Mascota' }}</h2>

    <div *ngIf="isLoading" class="loading">
      <div class="spinner"></div>
      <p>Cargando...</p>
    </div>

    <form *ngIf="!isLoading" (ngSubmit)="onSubmit()" #petForm="ngForm">
      <!-- Image Upload -->
      <div class="form-group image-upload">
        <label>Imagen de la Mascota</label>
        <div class="image-preview" *ngIf="imagePreview">
          <img [src]="imagePreview" alt="Preview" />
        </div>
        <input
          type="file"
          accept="image/jpeg,image/png,image/webp"
          (change)="onFileSelected($event)"
          [disabled]="isSaving"
        />
      </div>

      <!-- Name -->
      <div class="form-group">
        <label for="name">Nombre *</label>
        <input
          type="text"
          id="name"
          name="name"
          [(ngModel)]="petData.name"
          required
          placeholder="Nombre de la mascota"
          [disabled]="isSaving"
        />
      </div>

      <!-- Species and Breed -->
      <div class="form-row">
        <div class="form-group">
          <label for="species">Especie *</label>
          <input
            type="text"
            id="species"
            name="species"
            [(ngModel)]="petData.species"
            required
            placeholder="Ej: Perro, Gato"
            [disabled]="isSaving"
          />
        </div>

        <div class="form-group">
          <label for="breed">Raza</label>
          <input
            type="text"
            id="breed"
            name="breed"
            [(ngModel)]="petData.breed"
            placeholder="Ej: Labrador, Siamés"
            [disabled]="isSaving"
          />
        </div>
      </div>

      <!-- Sex and Size -->
      <div class="form-row">
        <div class="form-group">
          <label for="sex">Sexo *</label>
          <select id="sex" name="sex" [(ngModel)]="petData.sex" required [disabled]="isSaving">
            <option *ngFor="let sex of sexes" [value]="sex">{{ sex }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="size">Tamaño *</label>
          <select id="size" name="size" [(ngModel)]="petData.size" required [disabled]="isSaving">
            <option *ngFor="let size of sizes" [value]="size">{{ size }}</option>
          </select>
        </div>
      </div>

      <!-- Age and Color -->
      <div class="form-row">
        <div class="form-group">
          <label for="age">Edad (años)</label>
          <input
            type="number"
            id="age"
            name="age"
            [(ngModel)]="petData.age"
            min="0"
            placeholder="0"
            [disabled]="isSaving"
          />
        </div>

        <div class="form-group">
          <label for="color">Color</label>
          <input
            type="text"
            id="color"
            name="color"
            [(ngModel)]="petData.color"
            placeholder="Ej: Negro, Blanco"
            [disabled]="isSaving"
          />
        </div>
      </div>

      <!-- Status (only for edit) -->
      <div class="form-group" *ngIf="isEditMode">
        <label for="status">Estado *</label>
        <select id="status" name="status" [(ngModel)]="petData.status" required [disabled]="isSaving">
          <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
        </select>
      </div>

      <!-- Description -->
      <div class="form-group">
        <label for="description">Descripción *</label>
        <textarea
          id="description"
          name="description"
          [(ngModel)]="petData.description"
          rows="4"
          placeholder="Describe a la mascota (mínimo 10 caracteres)..."
          [disabled]="isSaving"
          required
          minlength="10"
          maxlength="500"
        ></textarea>
        <small class="help-text">Mínimo 10 caracteres, máximo 500</small>
      </div>

      <!-- Error Message -->
      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <!-- Action Buttons -->
      <div class="form-actions">
        <button type="button" (click)="cancel()" class="btn-cancel" [disabled]="isSaving">
          Cancelar
        </button>
        <button type="submit" class="btn-submit" [disabled]="!petForm.valid || isSaving">
          <span *ngIf="!isSaving">{{ isEditMode ? 'Actualizar' : 'Crear' }}</span>
          <span *ngIf="isSaving">Guardando...</span>
        </button>
      </div>
    </form>
  </div>
</div>
