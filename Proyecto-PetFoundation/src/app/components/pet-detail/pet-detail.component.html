<div class="pet-detail-container" *ngIf="!isLoading && pet">
  <div class="back-button">
    <button (click)="goBack()" class="btn-back">â† Volver a la lista</button>
  </div>

  <div class="pet-detail-card">
    <div class="pet-image-section">
      <img [src]="pet.coverImageUrl || 'assets/default-pet.svg'" [alt]="pet.name" class="pet-main-image" />
      <div class="pet-status-badge" [ngClass]="'status-' + pet.status.toLowerCase()">
        {{ pet.status }}
      </div>
    </div>

    <div class="pet-info-section">
      <h1>{{ pet.name }}</h1>
      
      <div class="pet-quick-info">
        <div class="info-item">
          <span class="label">ğŸ¾ Especie:</span>
          <span class="value">{{ pet.species }}</span>
        </div>
        <div class="info-item" *ngIf="pet.breed">
          <span class="label">ğŸ·ï¸ Raza:</span>
          <span class="value">{{ pet.breed }}</span>
        </div>
        <div class="info-item">
          <span class="label">âš¤ Sexo:</span>
          <span class="value">{{ pet.sex }}</span>
        </div>
        <div class="info-item">
          <span class="label">ğŸ“ TamaÃ±o:</span>
          <span class="value">{{ pet.size }}</span>
        </div>
        <div class="info-item" *ngIf="pet.age">
          <span class="label">ğŸ‚ Edad:</span>
          <span class="value">{{ pet.age }} aÃ±os</span>
        </div>
        <div class="info-item" *ngIf="pet.color">
          <span class="label">ğŸ¨ Color:</span>
          <span class="value">{{ pet.color }}</span>
        </div>
      </div>

      <div class="pet-description" *ngIf="pet.description">
        <h3>Sobre {{ pet.name }}</h3>
        <p>{{ pet.description }}</p>
      </div>

      <div class="pet-metadata">
        <small>Publicado: {{ pet.createdAt | date:'medium' }}</small>
        <small *ngIf="pet.updatedAt">Actualizado: {{ pet.updatedAt | date:'medium' }}</small>
      </div>

      <div class="action-buttons">
        <button
          *ngIf="isAuthenticated && !isAdmin && pet.status === 'Available'"
          (click)="openAdoptionModal()"
          class="btn-adopt"
          [disabled]="isAdopting"
        >
          <span *ngIf="!isAdopting">â¤ï¸ Solicitar AdopciÃ³n</span>
          <span *ngIf="isAdopting">Enviando...</span>
        </button>

        <button *ngIf="isAdmin" (click)="editPet()" class="btn-edit-detail">
          âœï¸ Editar Mascota
        </button>

        <button *ngIf="isAdmin" (click)="toggleQrCode()" class="btn-qr-toggle">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7" rx="1"/>
            <rect x="14" y="3" width="7" height="7" rx="1"/>
            <rect x="3" y="14" width="7" height="7" rx="1"/>
            <rect x="14" y="14" width="3" height="3"/>
            <rect x="18" y="14" width="3" height="3"/>
            <rect x="14" y="18" width="3" height="3"/>
            <rect x="18" y="18" width="3" height="3"/>
          </svg>
          {{ showQrSection ? 'Ocultar QR' : 'Ver QR' }}
        </button>

        <button *ngIf="!isAuthenticated" (click)="goBack()" class="btn-secondary">
          Inicia sesiÃ³n para adoptar
        </button>
      </div>

      <!-- QR Code Section -->
      <div class="qr-section" *ngIf="showQrSection && isAdmin">
        <div class="qr-card">
          <canvas #qrCanvas></canvas>
          <p class="qr-label">ID: {{ pet.id }} â€” {{ pet.name }}</p>
          <button class="btn-download-qr" (click)="downloadQrCode()">
            Descargar QR
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="isLoading" class="loading">
  <div class="spinner"></div>
  <p>Cargando informaciÃ³n de la mascota...</p>
</div>

<!-- Modal para solicitud de adopciÃ³n -->
<app-adoption-form-modal
  [isOpen]="showAdoptionModal"
  [petName]="pet?.name || ''"
  [petSpecies]="pet?.species || ''"
  [isLoading]="isAdopting"
  (confirm)="requestAdoption($event)"
  (cancel)="closeAdoptionModal()"
></app-adoption-form-modal>

<!-- Modal de Ã©xito -->
<app-modal
  [isOpen]="showSuccessModal"
  title="âœ… Â¡Solicitud Enviada!"
  message="Tu solicitud de adopciÃ³n ha sido enviada exitosamente. Te redirigiremos a tus solicitudes..."
  [showInput]="false"
  [showCancel]="false"
  confirmText="Ver Solicitudes"
  (confirm)="closeSuccessModal()"
></app-modal>

<!-- Modal de error -->
<app-modal
  [isOpen]="showErrorModal"
  title="âŒ Error"
  [message]="errorMessage"
  [showInput]="false"
  [showCancel]="false"
  confirmText="Cerrar"
  (confirm)="closeErrorModal()"
></app-modal>
